# snya.li

## Разработка

### Работа с репозиторием

#### Бранчинг
```
$ git checkout master
$ git pull
$ git checkout -b номер_тикета-описание-в-двух-словах
... редактируем файлы, делаем что хотим, потом git add и commit ...
$ git push -u origin номер_тикета-описание-в-двух-словах
```

#### Коммиты

Коммиты должны быть логически завершенными (читабельными), как если бы ты объяснял другому человеку что ты сделал.
Примеры: "Добавил модель для юзера", "Добавил вью для админки" и т.д.

Коммитов со всей кучей изменений следует избегать. Их обычно можно разбить на несколько коммитов.

Если неверное сообщение в последнем коммите (например, забыл что-то указать), можно его отредактировать:
```
$ git commit --amend
или сразу с сообщением
$ git commit --amend -m "New commit message"
```

Если был сделан неверный коммит, можно отменить последний коммит (коммиты):
```
$ git reset HEAD~1
```

Если изменения уже были выгружены на github, можно форсировать замену ветви отправляемой:
```
$ git push origin ветвь -f
```

#### Мержинг

После того как функционал закончен и проверен на работоспособность, делается пулл-реквест (через веб-интерфейс github).

На пулл-реквест назначается ревьюер, чья задача - проверить работоспособность кода, стиль написания, и т.д. перед внесением в главную ветвь.

В дальнейшем комментарии (в т.ч. построчно) могут писаться прямо в пулл-реквесте, а дополнительные изменения могут вносится обычными коммитами и выгрузкой в той же ветви.

### Инфраструктура

Задачи по администрированию и изменениям настроек пакетов по и серверов документируются в тикетах github. Ссылки на использованные руководства по настройке и/или перечень комманд с комментариями приветствуются, так как документируют текущее состояние развернутого ПО на серверах.

### Стили форматирования кода

Важно использовать общий стиль для форматирования кода, иначе чтение чужого или даже своего забытого кода будет сопровождаться болью в попе.

TODO: выбрать стили

## Тестирование

Цель автоматизированного тестирования - не дать процессу разработки новых функций сломать текущие функции.
Ручное тестирование занимает долгое время и с ростом функционала занимает всё большее и большее время.
Тестировать чужой функционал вручную при совместной разработке - вдвойне сложнеее, особенно если разработчик не
знаком со всеми деталями работы некоторых частей проекта.
Тесты - дополнительная документация к написанному коду.

Предполагается делать многоуровневое тестирование:
- Модульное (конкретные фунцкии);
- Поведенческое (фиксируется текущее поведение системы и при изменениях проверяется на регрессии);
- Функциональное тестирование (тестирование непосредственно работы функций, например, входа пользователя);
- Интеграцинное тестирование (тестируется возможность работы модулей совместно).

В идеале процесс разработки идет итеративно между написанием теста и кода. Тест пишется пока код не перестает проходить тест. Далее код пишется пока тест не начинает проходить успешно. Затем снова дорабатывается тест, т.д.

TODO: выбрать по для каждого вида тестов, написать примеры тестов, описать процедуру запуска проверки.

## Развертывание

Внесение изменений в текушую *продакшн* версию сайта возможно только через главную ветвь репозитория. Перед обновлением сайта следует сообщать в общий чат (вконтакте).
Предполагается наличие git репозитория с ветвью master в корне сервера и простое обновление файлов используя:
```
$ git pull
```
Если требуются дополнительные измениения, в т.ч. ручные, то это документируется подобно инфраструктурным тикетам, покомандно.

Сперва обновляется dev.snya.li, проводится тестирование. Затем можно обновлять боевой сервер.